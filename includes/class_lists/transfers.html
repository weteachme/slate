<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>API Documentation</title>

    <link href="../../stylesheets/screen.css" rel="stylesheet" type="text/css" media="screen" />
    <link href="../../stylesheets/print.css" rel="stylesheet" type="text/css" media="print" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
      <script src="../../javascripts/all_nosearch.js" type="text/javascript"></script>

  </head>

  <body class="includes includes_class_lists includes_class_lists_transfers">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="../../images/navbar.png" />
      </span>
    </a>
    <div class="tocify-wrapper">
      <img width="120" src="../../images/logo.png" />
      <div id="toc">
      </div>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h2 id="transfer-class">Transfer Class</h2>
<pre class="highlight shell"><code>curl 
  -X POST
  -H <span class="s2">"Accept: application/vnd.api+json"</span> 
  <span class="s2">"https://api.weteachme.com/v1/class-lists/123123/transfers
  -d '{
    "</span>data<span class="s2">": {
      "</span><span class="nb">type</span><span class="s2">": "</span>class-lists/transfers<span class="s2">",
      "</span>attributes<span class="s2">": {
        "</span>attendee-ids<span class="s2">": [1,2,3,4,5]
      },
      "</span>relationships<span class="s2">":{
        "</span>class-list<span class="s2">":{
          "</span>data<span class="s2">":{
             "</span><span class="nb">type</span><span class="s2">": "</span>class-lists<span class="s2">",
             "</span>id<span class="s2">": 123123
          }
        }
      }
    }
  }'
  -H "</span>API-KEY: meowmeowmeow<span class="s2">"
</span></code></pre>
<pre class="highlight ruby"><code><span class="nb">require</span> <span class="s1">'httparty'</span>

<span class="n">payload</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">"data"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"class-lists/transfers"</span><span class="p">,</span>
    <span class="s2">"attributes"</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">"attendee-ids"</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
    <span class="p">},</span>
    <span class="s2">"relationships"</span><span class="p">:{</span>
      <span class="s2">"class-list"</span><span class="p">:{</span>
        <span class="s2">"data"</span><span class="p">:{</span>
           <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"class-lists"</span><span class="p">,</span>
           <span class="s2">"id"</span><span class="p">:</span> <span class="mi">123123</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="no">HTTParty</span><span class="p">.</span><span class="nf">post</span><span class="p">(</span>
  <span class="s2">"https://api.weteachme.com/v1/class-lists/123123/transfers"</span><span class="p">,</span>
  <span class="n">payload</span><span class="p">,</span>
  <span class="ss">headers: </span><span class="p">{</span>
    <span class="s2">"Accept"</span> <span class="o">=&gt;</span> <span class="s1">'application/vnd.api+json'</span><span class="p">,</span> 
    <span class="s2">"API-KEY"</span> <span class="o">=&gt;</span> <span class="n">meowmeowmeow</span><span class="s2">"
  }
);

</span></code></pre>

<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
   </span><span class="nt">"data"</span><span class="p">:{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">123123</span><span class="p">,</span><span class="w">
      </span><span class="nt">"type"</span><span class="p">:</span><span class="s2">"class-lists/transfers"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"links"</span><span class="p">:{</span><span class="w">
         </span><span class="nt">"self"</span><span class="p">:</span><span class="s2">"http://api-dev.weteachme.com:3000/v1/class-lists/transfers/123123"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nt">"relationships"</span><span class="p">:{</span><span class="w">
         </span><span class="nt">"class-list"</span><span class="p">:{</span><span class="w">
            </span><span class="nt">"links"</span><span class="p">:{</span><span class="w">
               </span><span class="nt">"self"</span><span class="p">:</span><span class="s2">"http://api-dev.weteachme.com:3000/v1/class-lists/transfers/123123/relationships/class-list"</span><span class="p">,</span><span class="w">
               </span><span class="nt">"related"</span><span class="p">:</span><span class="s2">"http://api-dev.weteachme.com:3000/v1/class-lists/transfers/123123/class-list"</span><span class="w">
            </span><span class="p">}</span><span class="w">
         </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
   </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>This endpoint transfers attendees.</p>

<h3 id="scenario-1-transfer-to-same-date-no-merchandise">Scenario 1 - Transfer to same date (no merchandise)</h3>

<table><thead>
<tr>
<th>Steps</th>
<th>Actions</th>
</tr>
</thead><tbody>
<tr>
<td>When</td>
<td>vendor transfers all selected attendees to a different ticket within the same class date</td>
</tr>
<tr>
<td>Then</td>
<td>a transfer record is created for each attendee</td>
</tr>
<tr>
<td>Then</td>
<td>attendee is switched to another ticket</td>
</tr>
<tr>
<td>Then</td>
<td>an immediate due-now payment is generated for the transfer</td>
</tr>
<tr>
<td>Then</td>
<td>it processes payment only if requested by vendor</td>
</tr>
<tr>
<td>Then</td>
<td>it sends transfer email</td>
</tr>
<tr>
<td>Then</td>
<td>it logs the transfer activity</td>
</tr>
</tbody></table>

<h3 id="scenario-2-transfer-to-different-date">Scenario 2 - Transfer to different date</h3>

<table><thead>
<tr>
<th>Steps</th>
<th>Actions</th>
</tr>
</thead><tbody>
<tr>
<td>When</td>
<td>vendor transfers all selected attendees to a different class date</td>
</tr>
<tr>
<td>Then</td>
<td>a transfer record is created for each attendee</td>
</tr>
<tr>
<td>Then</td>
<td>it makes sure the new date is not sold out</td>
</tr>
<tr>
<td>Then</td>
<td>it finds or creates the new cart for the new class date</td>
</tr>
<tr>
<td>Then</td>
<td>attendee is swtiched to the new cart</td>
</tr>
<tr>
<td>Then</td>
<td>new cart is set as completed</td>
</tr>
<tr>
<td>Then</td>
<td>linked merchandise for the previous date is moved to the new date</td>
</tr>
<tr>
<td>Then</td>
<td>an immediate due-now payment is generated for the transfer</td>
</tr>
<tr>
<td>Then</td>
<td>it processes payment only if requested by vendor</td>
</tr>
<tr>
<td>Then</td>
<td>it sends transfer email</td>
</tr>
<tr>
<td>Then</td>
<td>it logs the transfer activity</td>
</tr>
</tbody></table>

<h3 id="scenario-3-transfer-with-merchandise">Scenario 3 - Transfer with merchandise</h3>

<table><thead>
<tr>
<th>Steps</th>
<th>Actions</th>
</tr>
</thead><tbody>
<tr>
<td>When</td>
<td>transfer is completed</td>
</tr>
<tr>
<td>Then</td>
<td>merchandise is attached to the new date</td>
</tr>
<tr>
<td>Then</td>
<td>recurring payments for merchandise are also generated</td>
</tr>
</tbody></table>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">POST https://api.weteachme.com/v1/class-lists/123123/transfers</code></p>

      </div>
      <div class="dark-box">
      </div>
    </div>
  </body>
</html>
